<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:BereitschaftsPlaner.Avalonia.ViewModels"
        x:Class="BereitschaftsPlaner.Avalonia.Views.ImportPreviewWindow"
        x:DataType="vm:ImportPreviewViewModel"
        Title="Import-Vorschau"
        Width="900" Height="600"
        MinWidth="700" MinHeight="500"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource SurfaceBrush}"
        FontFamily="{DynamicResource SansFont}"
        FontSize="14">

    <Design.DataContext>
        <vm:ImportPreviewViewModel/>
    </Design.DataContext>

    <Grid Margin="40">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Title -->
        <TextBlock Grid.Row="0"
                   Text="Import-Vorschau"
                   Classes="H1"
                   Margin="0,0,0,8"/>

        <!-- Info Header -->
        <Border Grid.Row="1"
                Classes="BentoCard"
                Background="#FAFAFA"
                Margin="0,0,0,24">
            <StackPanel Spacing="8">
                <TextBlock Text="STATUS" Classes="Label"/>
                <TextBlock Text="{Binding StatusMessage}"
                           Classes="H2"
                           FontSize="18"
                           Foreground="{Binding StatusColor}"/>
            </StackPanel>
        </Border>

        <!-- Data Preview (ItemsControl) -->
        <Border Grid.Row="2"
                Classes="BentoCard"
                Margin="0,0,0,24"
                ClipToBounds="True">
            <StackPanel Spacing="16">
                <TextBlock Text="DATENVORSCHAU" Classes="Label"/>
                <Border BorderBrush="{DynamicResource BorderBrush}"
                        BorderThickness="1"
                        CornerRadius="6"
                        MaxHeight="350"
                        ClipToBounds="True">
                    <ScrollViewer VerticalScrollBarVisibility="Auto"
                                  HorizontalScrollBarVisibility="Disabled">
                        <ItemsControl ItemsSource="{Binding PreviewData}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border BorderBrush="{DynamicResource BorderBrush}"
                                            BorderThickness="0,0,0,1"
                                            Padding="12,8">
                                        <TextBlock Text="{Binding}"
                                                   Classes="Body"
                                                   TextWrapping="Wrap"
                                                   MaxWidth="800"/>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Border>
                <TextBlock Text="{Binding PreviewData.Count, StringFormat={}{0} EintrÃ¤ge}"
                           Classes="Body"
                           Foreground="{DynamicResource TextMutedBrush}"
                           FontStyle="Italic"/>
            </StackPanel>
        </Border>

        <!-- Error Details (if any) -->
        <Border Grid.Row="3"
                Classes="BentoCard"
                IsVisible="{Binding HasErrors}"
                Background="#FFF9E6"
                BorderBrush="#E8B931"
                BorderThickness="0,0,0,2"
                Margin="0,0,0,24">
            <StackPanel Spacing="12">
                <TextBlock Text="WARNUNGEN" Classes="Label" Foreground="#B8860B"/>
                <TextBox Text="{Binding ErrorDetails}"
                         IsReadOnly="True"
                         TextWrapping="Wrap"
                         MaxHeight="100"
                         BorderThickness="0"
                         Background="Transparent"
                         Foreground="{DynamicResource TextDarkBrush}"
                         Classes="Body"/>
            </StackPanel>
        </Border>

        <!-- Buttons -->
        <StackPanel Grid.Row="4"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    Spacing="12">
            <Button Content="Abbrechen"
                    Classes="SecondaryAction"
                    Width="140"
                    Command="{Binding CancelCommand}"/>
            <Button Content="Importieren"
                    Classes="TrustAction"
                    Width="160"
                    IsEnabled="{Binding CanImport}"
                    Command="{Binding ConfirmCommand}"/>
        </StackPanel>
    </Grid>
</Window>
